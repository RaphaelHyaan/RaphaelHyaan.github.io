<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨ | Raphael's Home</title><meta name="author" content="Raphael Hyaan"><meta name="copyright" content="Raphael Hyaan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨  ä»‹ç»  2013 å¹´ï¼ŒDiederik P. Kingma å’Œ Max Welling å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ï¼Œä¸ºä¸€ç§ç§°ä¸ºå˜åˆ†è‡ªç¼–ç å™¨ (VAE) çš„ç¥ç»ç½‘ç»œå¥ å®šäº†åŸºç¡€ã€‚  æ•…äº‹  ğŸ’¡ æƒ³è±¡ä¸€ä¸‹ï¼Œä½ é¢å‰çš„åœ°æ¿ä¸Šå †æ»¡äº†ä½ æ‰€æœ‰çš„è¡£æœâ€”â€”è£¤å­ã€ä¸Šè¡£ã€é‹å­å’Œå¤–å¥—ï¼Œæ¬¾å¼å„å¼‚ã€‚ä½ çš„é€ å‹å¸ˆå¸ƒè±æ©è¶Šæ¥è¶Šæ²®ä¸§ï¼Œå› ">
<meta property="og:type" content="article">
<meta property="og:title" content="Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨">
<meta property="og:url" content="http://raphaelhyaan.cn/2024/01/20/Generative_3/index.html">
<meta property="og:site_name" content="Raphael&#39;s Home">
<meta property="og:description" content="Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨  ä»‹ç»  2013 å¹´ï¼ŒDiederik P. Kingma å’Œ Max Welling å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ï¼Œä¸ºä¸€ç§ç§°ä¸ºå˜åˆ†è‡ªç¼–ç å™¨ (VAE) çš„ç¥ç»ç½‘ç»œå¥ å®šäº†åŸºç¡€ã€‚  æ•…äº‹  ğŸ’¡ æƒ³è±¡ä¸€ä¸‹ï¼Œä½ é¢å‰çš„åœ°æ¿ä¸Šå †æ»¡äº†ä½ æ‰€æœ‰çš„è¡£æœâ€”â€”è£¤å­ã€ä¸Šè¡£ã€é‹å­å’Œå¤–å¥—ï¼Œæ¬¾å¼å„å¼‚ã€‚ä½ çš„é€ å‹å¸ˆå¸ƒè±æ©è¶Šæ¥è¶Šæ²®ä¸§ï¼Œå› ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg">
<meta property="article:published_time" content="2024-01-20T08:19:08.000Z">
<meta property="article:modified_time" content="2024-01-20T08:22:31.619Z">
<meta property="article:author" content="Raphael Hyaan">
<meta property="article:tag" content="å­¦ä¹ ç¬”è®°">
<meta property="article:tag" content="æ·±åº¦å­¦ä¹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg"><link rel="shortcut icon" href="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Freading1.png"><link rel="canonical" href="http://raphaelhyaan.cn/2024/01/20/Generative_3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-20 16:22:31'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/butterflyChange/css/code.css"><meta name="generator" content="Hexo 7.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Fe747243b42e6168d02fdf8bccbbd4ea.jpg" onerror="onerror=null;src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffriend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">111</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">14</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/Reading/"><i class="fa-fw fas fa-book"></i><span> Reading</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/Video/"><i class="fa-fw fas fa-video"></i><span> Video</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Raphael's Home"><span class="site-name">Raphael's Home</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/Reading/"><i class="fa-fw fas fa-book"></i><span> Reading</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> Gallery</span></a></li><li><a class="site-page child" href="/Video/"><i class="fa-fw fas fa-video"></i><span> Video</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-01-20T08:19:08.000Z" title="å‘è¡¨äº 2024-01-20 16:19:08">2024-01-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-01-20T08:22:31.619Z" title="æ›´æ–°äº 2024-01-20 16:22:31">2024-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%94%9F%E6%88%90%E5%BC%8F%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">å­¦ä¹ ç¬”è®°-ç”Ÿæˆå¼ç¥ç»ç½‘ç»œ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Chapter 3 Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="chapter-3-variational-autoencoders-è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨">Chapter 3
Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨</h1>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled.png" /></p>
<h1 id="ä»‹ç»">ä»‹ç»</h1>
<blockquote>
<p>2013 å¹´ï¼ŒDiederik P. Kingma å’Œ Max Welling
å‘è¡¨äº†ä¸€ç¯‡è®ºæ–‡ï¼Œä¸ºä¸€ç§ç§°ä¸ºå˜åˆ†è‡ªç¼–ç å™¨ (VAE) çš„ç¥ç»ç½‘ç»œå¥ å®šäº†åŸºç¡€ã€‚</p>
</blockquote>
<h2 id="æ•…äº‹">æ•…äº‹</h2>
<aside>
<p>ğŸ’¡
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ é¢å‰çš„åœ°æ¿ä¸Šå †æ»¡äº†ä½ æ‰€æœ‰çš„è¡£æœâ€”â€”è£¤å­ã€ä¸Šè¡£ã€é‹å­å’Œå¤–å¥—ï¼Œæ¬¾å¼å„å¼‚ã€‚ä½ çš„é€ å‹å¸ˆå¸ƒè±æ©è¶Šæ¥è¶Šæ²®ä¸§ï¼Œå› ä¸ºä»–èŠ±äº†å¾ˆé•¿æ—¶é—´æ‰èƒ½æ‰¾åˆ°ä½ éœ€è¦çš„ç‰©å“ï¼Œå› æ­¤ä»–åˆ¶å®šäº†ä¸€ä¸ªèªæ˜çš„è®¡åˆ’ã€‚ä»–å‘Šè¯‰ä½ æŠŠä½ çš„è¡£æœæ•´ç†æˆä¸€ä¸ªæ— é™é«˜å’Œæ— é™å®½çš„è¡£æŸœã€‚å½“æ‚¨æƒ³è¦ç´¢å–ç‰¹å®šç‰©å“æ—¶ï¼Œæ‚¨åªéœ€å‘Šè¯‰å¸ƒè±æ©å®ƒçš„ä½ç½®ï¼Œä»–å°±ä¼šä½¿ç”¨ä»–å€¼å¾—ä¿¡èµ–çš„ç¼çº«æœºä»å¤´å¼€å§‹ç¼åˆ¶è¯¥ç‰©å“ã€‚å¾ˆå¿«å°±ä¼šå‘ç°ï¼Œæ‚¨éœ€è¦å°†ç›¸ä¼¼çš„é¡¹ç›®å½¼æ­¤é è¿‘æ”¾ç½®ï¼Œä»¥ä¾¿
Brian å¯ä»¥ä»…æ ¹æ®å…¶ä½ç½®å‡†ç¡®åœ°é‡æ–°åˆ›å»ºæ¯ä¸ªé¡¹ç›®ã€‚</p>
<p>ç»è¿‡å‡ å‘¨çš„ç»ƒä¹ ï¼Œä½ å’Œå¸ƒè±æ©å·²ç»é€‚åº”äº†å½¼æ­¤å¯¹è¡£æŸœå¸ƒå±€çš„ç†è§£ã€‚ç°åœ¨æ‚¨å¯ä»¥å‘Šè¯‰å¸ƒè±æ©æ‚¨æƒ³è¦çš„ä»»ä½•è¡£æœçš„ä½ç½®ï¼Œä»–å¯ä»¥ä»å¤´å¼€å§‹å‡†ç¡®åœ°ç¼åˆ¶å®ƒï¼è¿™ç»™äº†ä½ ä¸€ä¸ªæƒ³æ³•â€”â€”å¦‚æœä½ ç»™å¸ƒè±æ©ä¸€ä¸ªç©ºçš„è¡£æŸœä½ç½®ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<strong>ä»¤ä½ æƒŠè®¶çš„æ˜¯ï¼Œä½ å‘ç°å¸ƒè±æ©èƒ½å¤Ÿå®Œå…¨ç”Ÿæˆä»¥å‰ä¸å­˜åœ¨çš„æ–°è¡£æœï¼</strong>è¿™ä¸ªè¿‡ç¨‹å¹¶ä¸å®Œç¾ï¼Œä½†ä½ ç°åœ¨æœ‰æ— é™çš„é€‰æ‹©æ¥ç”Ÿæˆæ–°è¡£æœï¼Œåªéœ€åœ¨æ— é™è¡£æŸœä¸­é€‰æ‹©ä¸€ä¸ªç©ºä½ç½®ï¼Œç„¶åè®©å¸ƒè±æ©ç”¨ç¼çº«æœºæ–½å±•ä»–çš„é­”æ³•ã€‚</p>
</aside>
<h1 id="è‡ªåŠ¨ç¼–ç å™¨">è‡ªåŠ¨ç¼–ç å™¨</h1>
<h3 id="ä¸æ•…äº‹çš„å¯¹åº”">ä¸æ•…äº‹çš„å¯¹åº”</h3>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_1.png" /></p>
<p>å°†æ¯ä»¶è¡£æœç§»åŠ¨åˆ°è¡£æŸœä¸­çš„æŸä¸ªä½ç½®ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç¼–ç ã€‚å¸ƒè±æ©æ‰®æ¼”è§£ç å™¨çš„è§’è‰²ï¼Œåœ¨è¡£æŸœä¸­æ‰¾åˆ°ä¸€ä¸ªä½ç½®å¹¶å°è¯•é‡æ–°åˆ›å»ºè¯¥ç‰©å“ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè§£ç ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå›¾ä¸­çš„è£¤å­è¢«ç¼–ç ä¸ºç‚¹ [6.3,
â€“0.9]ã€‚è¯¥å‘é‡ä¹Ÿç§°ä¸º<strong>åµŒå…¥<em>embedding</em></strong>ï¼Œå› ä¸ºç¼–ç å™¨å°è¯•å°†å°½å¯èƒ½å¤šçš„ä¿¡æ¯åµŒå…¥å…¶ä¸­ï¼Œä»¥ä¾¿è§£ç å™¨å¯ä»¥äº§ç”Ÿå‡†ç¡®çš„é‡å»º</p>
<h3 id="è‡ªåŠ¨ç¼–ç å™¨-1">è‡ªåŠ¨ç¼–ç å™¨</h3>
<blockquote>
<p>è‡ªåŠ¨ç¼–ç å™¨åªæ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œç»è¿‡è®­ç»ƒæ¥æ‰§è¡Œå¯¹é¡¹ç›®è¿›è¡Œç¼–ç å’Œè§£ç çš„ä»»åŠ¡ï¼Œä»¥ä¾¿è¯¥è¿‡ç¨‹çš„è¾“å‡ºå°½å¯èƒ½æ¥è¿‘åŸå§‹é¡¹ç›®ã€‚</p>
</blockquote>
<h3 id="fashion-mnist-æ•°æ®é›†">Fashion-MNIST æ•°æ®é›†</h3>
<p>Fashion-MNISTæ˜¯ä¸€ä¸ªæ›¿ä»£MNISTæ‰‹å†™æ•°å­—é›†çš„å›¾åƒæ•°æ®é›†ã€‚å…¶æ¶µç›–äº†10ç§ç±»åˆ«çš„è¡£ç‰©ï¼ŒåŒ…æ‹¬Tæ¤ã€è£¤å­ã€å¥—å¤´è¡«ç­‰ç­‰ã€‚æ¯ä¸ªç±»åˆ«æœ‰7000ä¸ªè®­ç»ƒå›¾åƒå’Œ3000ä¸ªæµ‹è¯•å›¾åƒã€‚æ•°æ®é›†ä¸­çš„æ¯ä¸ªå›¾åƒéƒ½æ˜¯28x28çš„ç°åº¦å›¾åƒã€‚</p>
<p>********************åŠ è½½æ•°æ®é›†********************</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> datasets</span><br><span class="line">(x_train,y_train), (x_test,y_test) = datasets.fashion_mnist.load_data()</span><br></pre></td></tr></table></figure>
<p><strong>æ•°æ®é›†å¤„ç†</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">preprocess</span>(<span class="params">imgs</span>):</span><br><span class="line">	imgs = imgs.astype(<span class="string">&quot;float32&quot;</span>) / <span class="number">255.0</span></span><br><span class="line">	imgs = np.pad(imgs, ((<span class="number">0</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">2</span>)), constant_values=<span class="number">0.0</span>)</span><br><span class="line">	imgs = np.expand_dims(imgs, -<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">return</span> imgs</span><br><span class="line">x_train = preprocess(x_train)</span><br><span class="line">x_test = preprocess(x_test)</span><br></pre></td></tr></table></figure>
<h2 id="è‡ªåŠ¨ç¼–ç å™¨æ¶æ„">è‡ªåŠ¨ç¼–ç å™¨æ¶æ„</h2>
<p>è‡ªåŠ¨ç¼–ç å™¨æ˜¯ä¸€ä¸ªç”±ä¸¤éƒ¨åˆ†ç»„æˆçš„ç¥ç»ç½‘ç»œ</p>
<ul>
<li>ç¼–ç å™¨ç½‘ç»œï¼Œå°†é«˜ç»´è¾“å…¥æ•°æ®ï¼ˆä¾‹å¦‚å›¾åƒï¼‰å‹ç¼©ä¸ºä½ç»´åµŒå…¥å‘é‡</li>
<li>è§£ç å™¨ç½‘ç»œï¼Œå°†ç»™å®šçš„åµŒå…¥å‘é‡è§£å‹å›åŸå§‹å€¼åŸŸï¼ˆä¾‹å¦‚ï¼Œè¿”å›å›¾åƒï¼‰</li>
</ul>
<h3 id="ç¼–ç å™¨">ç¼–ç å™¨</h3>
<p>ç¼–ç å™¨åœ¨è‡ªåŠ¨ç¼–ç å™¨ä¸­ï¼Œç¼–ç å™¨çš„å·¥ä½œæ˜¯è·å–è¾“å…¥å›¾åƒå¹¶å°†å…¶æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ä¸­çš„åµŒå…¥å‘é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">encoder_input = layers.Input(</span><br><span class="line">shape=(<span class="number">32</span>, <span class="number">32</span>, <span class="number">1</span>), name = <span class="string">&quot;encoder_input&quot;</span></span><br><span class="line">)</span><br><span class="line">x = layers.Conv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), strides = <span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span>)(</span><br><span class="line">encoder_input</span><br><span class="line">)</span><br><span class="line">x = layers.Conv2D(<span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), strides = <span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span>)(x)</span><br><span class="line">x = layers.Conv2D(<span class="number">128</span>, (<span class="number">3</span>, <span class="number">3</span>), strides = <span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span>)(x)</span><br><span class="line">shape_before_flattening = K.int_shape(x)[<span class="number">1</span>:]</span><br><span class="line">x = layers.Flatten()(x)</span><br><span class="line">encoder_output = layers.Dense(<span class="number">2</span>, name=<span class="string">&quot;encoder_output&quot;</span>)(x)</span><br><span class="line">encoder = models.Model(encoder_input, encoder_output)</span><br></pre></td></tr></table></figure>
<h3 id="è½¬ç½®å·ç§¯å±‚">è½¬ç½®å·ç§¯å±‚</h3>
<p>æ ‡å‡†å·ç§¯å±‚å…è®¸æˆ‘ä»¬é€šè¿‡è®¾ç½® strides = 2
å°†è¾“å…¥å¼ é‡çš„ä¸¤ä¸ªç»´åº¦ï¼ˆé«˜åº¦å’Œå®½åº¦ï¼‰çš„å¤§å°å‡åŠã€‚å·ç§¯è½¬ç½®å±‚ä½¿ç”¨ä¸æ ‡å‡†å·ç§¯å±‚ç›¸åŒçš„åŸç†ï¼ˆåœ¨å›¾åƒä¸Šä¼ é€’è¿‡æ»¤å™¨ï¼‰ï¼Œä½†ä¸åŒä¹‹å¤„åœ¨äºè®¾ç½®
strides = 2 ä½¿è¾“å…¥å¼ é‡åœ¨ä¸¤ä¸ªç»´åº¦ä¸Šçš„å¤§å°åŠ å€ã€‚</p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_2.png" /></p>
<p>åœ¨ Keras ä¸­ï¼Œ<code>**Conv2DTranspose**</code>
å±‚å…è®¸æˆ‘ä»¬å¯¹å¼ é‡æ‰§è¡Œå·ç§¯è½¬ç½®æ“ä½œã€‚é€šè¿‡å †å è¿™äº›å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¥é•¿ 2
é€æ¸æ‰©å¤§æ¯å±‚çš„å¤§å°ï¼Œç›´åˆ°å›åˆ°åŸå§‹å›¾åƒå°ºå¯¸ 32 Ã— 32</p>
<h3 id="è§£ç å™¨">è§£ç å™¨</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">decoder_input = layers.Input(shape=(<span class="number">2</span>,), name=<span class="string">&quot;decoder_input&quot;</span>)</span><br><span class="line">x = layers.Dense(np.prod(shape_before_flattening))(decoder_input)</span><br><span class="line">x = layers.Reshape(shape_before_flattening)(x)</span><br><span class="line">x = layers.Conv2DTranspose(</span><br><span class="line"><span class="number">128</span>, (<span class="number">3</span>, <span class="number">3</span>), strides=<span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span></span><br><span class="line">)(x)</span><br><span class="line">x = layers.Conv2DTranspose(</span><br><span class="line"><span class="number">64</span>, (<span class="number">3</span>, <span class="number">3</span>), strides=<span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span></span><br><span class="line">)(x)</span><br><span class="line">x = layers.Conv2DTranspose(</span><br><span class="line"><span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), strides=<span class="number">2</span>, activation = <span class="string">&#x27;relu&#x27;</span>, padding=<span class="string">&quot;same&quot;</span></span><br><span class="line">)(x)</span><br><span class="line">decoder_output = layers.Conv2D(</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line">(<span class="number">3</span>, <span class="number">3</span>),</span><br><span class="line">strides = <span class="number">1</span>,</span><br><span class="line">activation=<span class="string">&quot;sigmoid&quot;</span>,</span><br><span class="line">padding=<span class="string">&quot;same&quot;</span>,</span><br><span class="line">name=<span class="string">&quot;decoder_output&quot;</span></span><br><span class="line">)(x)</span><br><span class="line">decoder = models.Model(decoder_input, decoder_output)</span><br></pre></td></tr></table></figure>
<h3 id="è¿æ¥ç¼–ç å™¨å’Œè§£ç å™¨">è¿æ¥ç¼–ç å™¨å’Œè§£ç å™¨</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autoencoder = Model(encoder_input, decoder(encoder_output))</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åªéœ€è¦æŒ‡å®šè‡ªåŠ¨ç¼–ç å™¨çš„è¾“å‡ºç¼–ç å™¨é€šè¿‡è§£ç å™¨åçš„è¾“å‡ºã€‚</p>
<h2 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h2>
<h3 id="é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°">é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</h3>
<ul>
<li>ä¼˜åŒ–å™¨é€‰æ‹©å¸¸è§„çš„Adamä¼˜åŒ–å™¨</li>
<li>æŸå¤±å‡½æ•°é€šå¸¸é€‰æ‹©åŸå§‹å›¾åƒå’Œé‡å»ºå›¾åƒçš„å„ä¸ªåƒç´ ä¹‹é—´çš„å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰æˆ–äºŒå…ƒäº¤å‰ç†µ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">autoencoder.<span class="built_in">compile</span>(optimizer=<span class="string">&quot;adam&quot;</span>, loss=<span class="string">&quot;binary_crossentropy&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰å’ŒäºŒå…ƒäº¤å‰ç†µï¼Œéƒ½æ˜¯åº¦é‡é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´å·®å¼‚çš„æ–¹æ³•</p>
<ul>
<li>å‡æ–¹æ ¹è¯¯å·®ï¼ˆRMSEï¼‰æ˜¯è§‚æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´å·®å¼‚çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚RMSE
å¯¹æ‰€æœ‰ç±»å‹çš„é¢„æµ‹é”™è¯¯éƒ½æœ‰ç›¸åŒçš„æƒé‡ï¼Œæ— è®ºé¢„æµ‹å€¼æ˜¯é«˜ä¼°è¿˜æ˜¯ä½ä¼°çœŸå®å€¼ã€‚</li>
<li>å¦ä¸€æ–¹é¢ï¼ŒäºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°åº¦é‡çš„æ˜¯é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„â€œè·ç¦»â€ã€‚äºŒå…ƒäº¤å‰ç†µæŸå¤±å‡½æ•°å¯¹é¢„æµ‹é”™è¯¯çš„å¤„ç†å¹¶ä¸å¯¹ç§°ã€‚å¦‚æœçœŸå®å€¼æ¥è¿‘1ï¼Œæ¨¡å‹é¢„æµ‹è¶Šæ¥è¿‘1ï¼ŒæŸå¤±å°±è¶Šå°ï¼›åä¹‹ï¼Œå¦‚æœçœŸå®å€¼æ¥è¿‘0ï¼Œæ¨¡å‹é¢„æµ‹è¶Šæ¥è¿‘0ï¼ŒæŸå¤±å°±è¶Šå°ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœä½ çš„æ¨¡å‹å¯¹æŸä¸ªå€¼çš„é¢„æµ‹ç»“æœè¿‡é«˜æˆ–è¿‡ä½ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°çš„å€¼ä¼šæ˜æ˜¾å¢åŠ ã€‚</li>
</ul>
<p>è¿™ä¸¤ç§æŸå¤±å‡½æ•°å„æœ‰ä¼˜åŠ¿ï¼Œé€‰æ‹©å“ªç§æŸå¤±å‡½æ•°åº”è¯¥æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚å’Œå®éªŒç»“æœæ¥å†³å®šã€‚</p>
<h3 id="å¼€å§‹è®­ç»ƒ">å¼€å§‹è®­ç»ƒ</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">autoencoder.fit(</span><br><span class="line">		x_train,</span><br><span class="line">		x_train,</span><br><span class="line">		epochs=<span class="number">5</span>,</span><br><span class="line">		batch_size=<span class="number">100</span>,</span><br><span class="line">		shuffle=<span class="literal">True</span>,</span><br><span class="line">		validation_data=(x_test, x_test),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="é‡å»ºå›¾åƒ">é‡å»ºå›¾åƒ</h3>
<blockquote>
<p>ä½¿ç”¨æµ‹è¯•æœºæµ‹è¯•é‡å»ºå›¾åƒçš„èƒ½åŠ›</p>
</blockquote>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_3.png" /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">example_images = x_test[:<span class="number">5000</span>]</span><br><span class="line">predictions = autoencoder.predict(example_images)</span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆæ–°çš„å›¾åƒ">ç”Ÿæˆæ–°çš„å›¾åƒ</h3>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_4.png" /></p>
<p>æˆ‘ä»¬é¦–å…ˆç”Ÿæˆè·å¾—å¯èƒ½çš„æ½œåœ¨ç©ºé—´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">embeddings = encoder.predict(example_images)</span><br><span class="line">mins, maxs = np.<span class="built_in">min</span>(embeddings, axis=<span class="number">0</span>), np.<span class="built_in">max</span>(embeddings, axis=<span class="number">0</span>)</span><br><span class="line">sample = np.random.uniform(mins, maxs, size=(<span class="number">18</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>æˆ‘ä»¬é¦–å…ˆé€šè¿‡ç¼–ç å™¨ï¼Œå¯¹è®­ç»ƒé›†çš„æ•°æ®è¿›è¡Œç¼–ç ä»¥è·å¾—å¯èƒ½çš„æ½œåœ¨ç©ºé—´ã€‚</li>
<li>ç„¶åæˆ‘ä»¬è®¤ä¸ºé‡‡æ ·ç©ºé—´æ˜¯åŒ…å«æ½œåœ¨ç©ºé—´çš„æœ€å°çŸ©å½¢ã€‚</li>
<li>åœ¨è¿™ä¸ªç©ºé—´å†…å‡åŒ€é‡‡æ ·ï¼Œå¹¶ä½¿ç”¨è§£ç å™¨è¿›è¡Œé¢„æµ‹</li>
</ul>
<p>ç”±æ­¤å³å¯ç”Ÿæˆæ–°çš„å›¾åƒï¼Œå¹¶ç»˜åˆ¶ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">18</span>  <span class="comment"># Number of images to display</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>, <span class="number">4</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="comment"># Display original images</span></span><br><span class="line">    <span class="comment"># ax = plt.subplot(2, n, i + 1)</span></span><br><span class="line">    <span class="comment"># plt.imshow(example_images[i].reshape(32, 32), cmap=&#x27;gray&#x27;)</span></span><br><span class="line">    <span class="comment"># plt.title(&quot;Original&quot;)</span></span><br><span class="line">    <span class="comment"># plt.axis(&#x27;off&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Display reconstructed images</span></span><br><span class="line">    ax = plt.subplot(<span class="number">2</span>, n, i + <span class="number">1</span> + n)</span><br><span class="line">    plt.imshow(reconstructions[i].reshape(<span class="number">32</span>, <span class="number">32</span>), cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">&quot;Reconstructed&quot;</span>)</span><br><span class="line">    plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="è‡ªåŠ¨ç¼–ç å™¨å­˜åœ¨çš„é—®é¢˜">è‡ªåŠ¨ç¼–ç å™¨å­˜åœ¨çš„é—®é¢˜</h2>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_5.png" /></p>
<p>è‡ªåŠ¨ç¼–ç å™¨å­˜åœ¨è‹¥å¹²é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¯ä»¥ä»å›¾ä¸­çœ‹å‡ºã€‚</p>
<ul>
<li>é¦–å…ˆï¼Œé‡‡æ ·ç©ºé—´å­˜åœ¨ç–å¯†ï¼Œå¦‚æ©™è‰²ç‚¹ï¼Œåœ¨å¯†åº¦è¾ƒé«˜çš„åœ°æ–¹é¢„æµ‹ä¼šæ›´åŠ å‡†ç¡®ï¼Œè€Œåœ¨ç©ºç™½éƒ¨åˆ†åˆ™é¢„æµ‹ä¸å‡†ç¡®ã€‚</li>
<li>å…¶æ¬¡ï¼Œä¸åŒç§ç±»ä¹‹é—´çš„æ½œåœ¨ç©ºé—´å­˜åœ¨äº¤å‰ï¼Œè¿™ä½¿å¾—åœ¨è¿™äº›é‡åˆéƒ¨åˆ†ï¼Œç”Ÿæˆå¹¶ä¸å‡†ç¡®ã€‚</li>
<li>æœ€åï¼Œæˆ‘ä»¬å¾ˆéš¾å–çš„åœ¨åˆç†çš„ä½ç½®è¿›è¡Œé‡‡æ ·ã€‚</li>
</ul>
<p>åŸºäºè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨æ”¹è¿›ã€‚</p>
<h1 id="ä½¿ç”¨pytorchçš„å°è¯•">ä½¿ç”¨pytorchçš„å°è¯•</h1>
<p>ç›®å‰å› ä¸ºå¯¹ä¸¤ç§æ–¹æ³•çš„ç†è§£å¦å°šä¸”ååˆ†æœ‰é™ï¼Œä¹Ÿéš¾ä»¥æ¯”è¾ƒä½¿ç”¨pytorchæ›´æ–¹ä¾¿è¿˜æ˜¯tensorflowæ›´æ–¹ä¾¿ï¼Œå› æ­¤åœ¨è¿™é‡Œè¡¥å……ä½¿ç”¨pytorchçš„æ–¹æ³•ã€‚</p>
<h3 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h3>
<p><strong>ä½¿ç”¨tensorflowå®ç°çš„ä»£ç </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">preprocess</span>(<span class="params">imgs</span>):</span><br><span class="line">    imgs = imgs.astype(<span class="string">&quot;float32&quot;</span>) / <span class="number">255.0</span></span><br><span class="line">    imgs = np.pad(imgs, ((<span class="number">0</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">2</span>)), constant_values=<span class="number">0.0</span>)</span><br><span class="line">    imgs = np.expand_dims(imgs, -<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> imgs</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>imgs = imgs.astype("float32") / 255.0</code></strong>ï¼šè¿™è¡Œä»£ç å°†å›¾åƒçš„æ•°æ®ç±»å‹è½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼Œå¹¶å°†åƒç´ å€¼å½’ä¸€åŒ–åˆ°0-1çš„èŒƒå›´ã€‚è¿™æ˜¯å› ä¸ºå›¾åƒçš„åŸå§‹åƒç´ å€¼é€šå¸¸åœ¨0-255ä¹‹é—´ï¼Œå½’ä¸€åŒ–å¯ä»¥ä½¿å¾—æ•°æ®æ›´é€‚åˆç¥ç»ç½‘ç»œçš„å¤„ç†ã€‚</li>
<li><strong><code>imgs = np.pad(imgs, ((0, 0), (2, 2), (2, 2)), constant_values=0.0)</code></strong>ï¼šè¿™è¡Œä»£ç å¯¹å›¾åƒè¿›è¡Œäº†å¡«å……æ“ä½œã€‚<strong><code>np.pad</code></strong>å‡½æ•°ä¼šåœ¨å›¾åƒçš„è¾¹ç¼˜æ·»åŠ é¢å¤–çš„åƒç´ ã€‚è¿™é‡Œï¼Œå®ƒåœ¨å›¾åƒçš„ä¸Šä¸‹å·¦å³å„æ·»åŠ äº†2ä¸ªåƒç´ ï¼Œå¡«å……çš„å€¼ä¸º0ã€‚</li>
<li><strong><code>imgs = np.expand_dims(imgs, -1)</code></strong>ï¼šè¿™è¡Œä»£ç å¢åŠ äº†ä¸€ä¸ªç»´åº¦ã€‚åœ¨å¤„ç†å›¾åƒæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä¸€ä¸ªè¡¨ç¤ºé¢œè‰²é€šé“çš„ç»´åº¦ã€‚å¯¹äºå½©è‰²å›¾åƒï¼Œè¿™ä¸ªç»´åº¦çš„å¤§å°é€šå¸¸ä¸º3ï¼ˆå¯¹åº”RGBä¸‰ä¸ªé¢œè‰²é€šé“ï¼‰ã€‚å¯¹äºç°åº¦å›¾åƒï¼Œè¿™ä¸ªç»´åº¦çš„å¤§å°ä¸º1ã€‚è¿™è¡Œä»£ç å°±æ˜¯åœ¨æœ€åä¸€ä¸ªç»´åº¦ï¼ˆ<strong><code>1</code></strong>è¡¨ç¤ºæœ€åä¸€ä¸ªç»´åº¦ï¼‰ä¸Šå¢åŠ äº†ä¸€ä¸ªå¤§å°ä¸º1çš„ç»´åº¦ã€‚</li>
</ul>
<p><strong>ä½¿ç”¨pytorchå®ç°çš„ä»£ç </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">transform = transform.Compose([</span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize((<span class="number">0.5</span>,), (<span class="number">0.5</span>,)),</span><br><span class="line">    transforms.Pad(<span class="number">2</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>transforms.ToTensor()</code></strong>ï¼šè¿™ä¸ªè½¬æ¢å°†PILå›¾åƒæˆ–è€…NumPyçš„ndarrayè½¬æ¢ä¸ºPyTorchçš„å¼ é‡ï¼ˆTensorï¼‰ã€‚å®ƒä¼šå°†å›¾åƒçš„åƒç´ å¼ºåº¦å€¼ä»0-255ï¼ˆå¸¸è§çš„æ•°æ®ç±»å‹ä¸ºuint8ï¼‰å˜ä¸º0-1çš„æµ®ç‚¹æ•°ï¼Œå¹¶ä¸”ï¼Œå®ƒè¿˜ä¼šæ”¹å˜æ•°æ®çš„ç»´åº¦ï¼Œå®ƒä¼šè‡ªåŠ¨ä¸ºå›¾åƒå¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œå¯¹äºå›¾åƒï¼Œç»´åº¦é€šå¸¸ä»<strong><code>(é«˜, å®½, é€šé“)</code></strong>å˜ä¸º<strong><code>(é€šé“, é«˜, å®½)</code></strong>ã€‚</li>
<li><strong><code>transforms.Normalize((0.5,), (0.5,))</code></strong>ï¼šè¿™ä¸ªè½¬æ¢ä¼šå¯¹å¼ é‡è¿›è¡Œå½’ä¸€åŒ–ã€‚è¿™é‡Œï¼Œ<strong><code>(0.5,)</code></strong>æ˜¯å‡å€¼ï¼Œ<strong><code>(0.5,)</code></strong>æ˜¯æ ‡å‡†å·®ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¼šä»æ¯ä¸ªé€šé“ä¸­å‡å»0.5ï¼Œç„¶åé™¤ä»¥0.5ã€‚è¿™æ ·åšå¯ä»¥ä½¿å¾—æ•°æ®çš„åˆ†å¸ƒæ¥è¿‘æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œå³å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1ï¼Œæœ‰åŠ©äºç¥ç»ç½‘ç»œçš„è®­ç»ƒã€‚</li>
<li><strong><code>transforms.Pad(2)</code></strong>ï¼šè¿™ä¸ªè½¬æ¢ä¼šåœ¨å›¾åƒçš„æ¯ä¸€è¾¹æ·»åŠ 2ä¸ªåƒç´ çš„å¡«å……ã€‚è¿™å¯¹äºæŸäº›å·ç§¯ç¥ç»ç½‘ç»œæ˜¯å¿…è¦çš„ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¼šå‡å°å›¾åƒçš„å°ºå¯¸ã€‚</li>
</ul>
<h3 id="æ•°æ®åŠ è½½">æ•°æ®åŠ è½½</h3>
<p>******************************************************ä½¿ç”¨tensorflowå®ç°çš„ä»£ç ******************************************************</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(x_train,y_train), (x_test,y_test) = datasets.fashion_mnist.load_data()</span><br><span class="line">x_train = preprocess(x_train)</span><br><span class="line">x_test = preprocess(x_test)</span><br></pre></td></tr></table></figure>
<p>******************************************ä½¿ç”¨pytorchå®ç°çš„ä»£ç ******************************************</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">trainset = datasets.FashionMNIST(<span class="string">&#x27;~/.pytorch/F_MNIST_data/&#x27;</span>, download=<span class="literal">True</span>, train=<span class="literal">True</span>, transform=transform)</span><br><span class="line">testset = datasets.FashionMNIST(<span class="string">&#x27;~/.pytorch/F_MNIST_data/&#x27;</span>, download=<span class="literal">True</span>, train=<span class="literal">False</span>, transform=transform)</span><br><span class="line"></span><br><span class="line">trainloader = torch.utils.data.DataLoader(trainset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">testloader = torch.utils.data.DataLoader(testset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h3 id="è‡ªåŠ¨ç¼–ç å™¨-2">è‡ªåŠ¨ç¼–ç å™¨</h3>
<p>åŸæœ¬çš„ç¼–ç å™¨çš„ä»£ç ä¸åœ¨è¿™é‡Œå±•ç¤ºã€‚</p>
<p>ä½¿ç”¨pytorchçš„å®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Autoencoder</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Autoencoder,self).__init__()</span><br><span class="line">        self.encoder = nn.Sequential(</span><br><span class="line">            nn.Conv2d(<span class="number">1</span>,<span class="number">32</span>,<span class="number">3</span>,stride = <span class="number">2</span>,padding = <span class="number">1</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Conv2d(<span class="number">32</span>,<span class="number">64</span>,<span class="number">3</span>,stride = <span class="number">2</span>,padding = <span class="number">1</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Conv2d(<span class="number">64</span>,<span class="number">128</span>,<span class="number">3</span>,stride = <span class="number">2</span>,padding = <span class="number">1</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Flatten(),</span><br><span class="line">            nn.Linear(<span class="number">128</span>*<span class="number">4</span>*<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">        )</span><br><span class="line">        self.decoder = nn.Sequential(</span><br><span class="line">            nn.Linear(<span class="number">2</span>,<span class="number">128</span>*<span class="number">4</span>*<span class="number">4</span>),</span><br><span class="line">            nn.Unflatten(<span class="number">1</span>,(<span class="number">128</span>,<span class="number">4</span>,<span class="number">4</span>)),</span><br><span class="line">            nn.ConvTranspose2d(<span class="number">128</span>,<span class="number">64</span>,<span class="number">3</span>,stride = <span class="number">2</span>,padding = <span class="number">1</span>,output_padding=<span class="number">1</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.ConvTranspose2d(<span class="number">64</span>, <span class="number">32</span>, <span class="number">3</span>, stride=<span class="number">2</span>, padding=<span class="number">1</span>, output_padding=<span class="number">1</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.ConvTranspose2d(<span class="number">32</span>, <span class="number">1</span>, <span class="number">3</span>, stride=<span class="number">2</span>, padding=<span class="number">1</span>, output_padding=<span class="number">1</span>),</span><br><span class="line">            nn.Sigmoid()            </span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x = self.encoder(x)</span><br><span class="line">        x = self.decoder(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<p>ç»“æ„åŸºæœ¬ä¸ä½¿ç”¨kerasçš„å®ç°ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºä¸åŒçš„å‡½æ•°çš„å‚æ•°å¹¶ä¸ç›¸åŒã€‚</p>
<h3 id="å¼€å§‹è®­ç»ƒ-1">å¼€å§‹è®­ç»ƒ</h3>
<p>ä½¿ç”¨ç›¸åŒçš„ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">model = Autoencoder().cuda()</span><br><span class="line">optimizer = optim.Adam(model.parameters())</span><br><span class="line">loss_function = nn.BCELoss().cuda()</span><br></pre></td></tr></table></figure>
<p>éœ€è¦è‡ªå·±è®¾ç½®è®­ç»ƒå¾ªç¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> data, _ <span class="keyword">in</span> trainloader:</span><br><span class="line">        data = data.cuda()</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        output = model(data)</span><br><span class="line">        loss = loss_function(output, data)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Epoch: <span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>, Loss: <span class="subst">&#123;loss.item()&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨">è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨</h1>
<h3 id="æ•…äº‹-1">æ•…äº‹</h3>
<p>ç°åœ¨å‡è®¾ï¼Œæ‚¨å†³å®šåˆ†é…ä¸€ä¸ªæ›´å®¹æ˜“æ‰¾åˆ°è¯¥ç‰©å“çš„<strong>ä¸€èˆ¬åŒºåŸŸ</strong>ï¼Œè€Œä¸æ˜¯å°†æ¯ä»¶è¡£æœæ”¾åœ¨è¡£æŸœä¸­çš„ä¸€ä¸ªä½ç½®ã€‚æ‚¨è®¤ä¸ºè¿™ç§æ›´è½»æ¾çš„ç‰©å“å®šä½æ–¹æ³•å°†æœ‰åŠ©äºè§£å†³å½“å‰è¡£æŸœä¸­å±€éƒ¨ä¸è¿ç»­æ€§çš„é—®é¢˜ã€‚</p>
<p>ä½ å°†å°è¯•å°†æ¯ä»¶ç‰©å“åŒºåŸŸçš„ä¸­å¿ƒå°½å¯èƒ½é è¿‘è¡£æŸœçš„ä¸­é—´ï¼Œå¹¶ä¸”è¿™ç§åå·®è·ç¦»ä¸­å¿ƒçš„ç‰©å“åº”å°½å¯èƒ½æ¥è¿‘ä¸€ç±³ï¼ˆä¸å°äºä¹Ÿä¸å¤§äºï¼‰ã€‚ä½ è¶Šåç¦»è¿™æ¡è§„åˆ™ï¼Œä½ å°±è¶Šéœ€è¦å‘å¸ƒè±æ©ä½œä¸ºä½ çš„é€ å‹å¸ˆæ”¯ä»˜æ›´å¤šè´¹ç”¨ã€‚</p>
<h2 id="æ¨¡å‹æ¶æ„çš„ä¿®æ”¹">æ¨¡å‹æ¶æ„çš„ä¿®æ”¹</h2>
<blockquote>
<p>ä»è‡ªåŠ¨ç¼–ç å™¨åˆ°å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼Œåªéœ€è¦æ”¹å˜ç¼–ç å™¨å’ŒæŸå¤±å‡½æ•°</p>
</blockquote>
<h3 id="å‘å¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ˜ å°„">å‘å¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ˜ å°„</h3>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_6.png" /></p>
<p>åœ¨è‡ªåŠ¨ç¼–ç å™¨ä¸­ï¼Œæ¯ä¸ªå›¾åƒéƒ½ç›´æ¥æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹ã€‚åœ¨å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ä¸­ï¼Œæ¯ä¸ªå›¾åƒéƒ½è¢«æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ä¸­æŸä¸ªç‚¹å‘¨å›´çš„å¤šå…ƒæ­£æ€åˆ†å¸ƒã€‚</p>
<p><strong>æ­£æ€åˆ†å¸ƒ</strong> æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å®šä¹‰æ­£æ€åˆ†å¸ƒ<span
class="math inline">\(N(\mu,\sigma)\)</span>ï¼š</p>
<p><span class="math display">\[
f\left(x \mid \mu, \sigma^2\right)=\frac{1}{\sqrt{2 \pi \sigma^2}}
e^{-\frac{(x-\mu)^2}{2 \sigma^2}}
\]</span></p>
<p><strong>ä»è¾“å…¥æ˜ å°„åˆ°å‡å€¼å‘é‡å’Œæ–¹å·®å‘é‡</strong>
ç¼–ç å™¨å°†è·å–æ¯ä¸ªè¾“å…¥å›¾åƒå¹¶å°†å…¶ç¼–ç ä¸ºå‡å€¼ã€æ–¹å·®ä¸¤ä¸ªå‘é‡ï¼Œè¿™ä¸¤ä¸ªå‘é‡å…±åŒå®šä¹‰æ½œåœ¨ç©ºé—´ä¸­çš„å¤šå…ƒæ­£æ€åˆ†å¸ƒã€‚</p>
<ul>
<li><span class="math inline">\(z_{mean}\)</span></li>
<li><span class="math inline">\(z_{log,var}\)</span>ï¼š<span
class="math inline">\(z_{log,var} = log(\sigma^2)\)</span></li>
</ul>
<p>ç”±æ­¤å¤šå…ƒæ­£æ€åˆ†å¸ƒè¢«å®šä¹‰ä¸ºï¼š</p>
<ul>
<li><span class="math inline">\(z = z_{mean}+exp(\frac 12\cdot
z_{log,var})\cdot \varepsilon\)</span></li>
</ul>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬èƒ½ä¿è¯æŸä¸ªç‚¹é™„è¿‘çš„éƒ¨åˆ†ä¹Ÿèƒ½è·Ÿè¿™ä¸ªç‚¹æœ‰æ›´å¤šçš„ç›¸ä¼¼æ€§</p>
<h3 id="é‡‡æ ·å±‚">é‡‡æ ·å±‚</h3>
<p><strong>é‡‡æ ·å±‚<em>Sampling</em></strong>
éšæˆ‘ä»¬è¦å®šä¹‰ä¸€ç§é‡‡æ ·å±‚ï¼Œå…è®¸æˆ‘ä»¬ä» <span
class="math inline">\(z_{mean}\)</span> å’Œ <span
class="math inline">\(z_{log,var}\)</span> å®šä¹‰çš„åˆ†å¸ƒä¸­è¿›è¡Œé‡‡æ ·ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Sampling</span>(layers.Layer):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">call</span>(<span class="params">self, inputs</span>):</span><br><span class="line">		z_mean, z_log_var = inputs</span><br><span class="line">		batch = tf.shape(z_mean)[<span class="number">0</span>]</span><br><span class="line">		dim = tf.shape(z_mean)[<span class="number">1</span>]</span><br><span class="line">		epsilon = K.random_normal(shape=(batch, dim))</span><br><span class="line">		<span class="keyword">return</span> z_mean + tf.exp(<span class="number">0.5</span> * z_log_var) * epsilon</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>Sampling</code>çš„ç±»ï¼Œå®ƒç»§æ‰¿äº†<code>layers.Layer</code>è¿™ä¸ªç±»ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Keraså±‚ã€‚è¿™ä¸ªè‡ªå®šä¹‰å±‚çš„ä¸»è¦ä½œç”¨æ˜¯ä»è¾“å…¥çš„å‡å€¼<code>z_mean</code>å’Œå¯¹æ•°æ–¹å·®<code>z_log_var</code>å®šä¹‰çš„å¤šå…ƒæ­£æ€åˆ†å¸ƒä¸­è¿›è¡Œé‡‡æ ·ã€‚</p>
<p><strong>å¯¹ Layer ç±»è¿›è¡Œå­ç±»åŒ–</strong> å¯ä»¥é€šè¿‡å¯¹æŠ½è±¡ Layer
ç±»è¿›è¡Œå­ç±»åŒ–å¹¶å®šä¹‰è°ƒç”¨æ–¹æ³•æ¥åœ¨ Keras
ä¸­åˆ›å»ºæ–°å±‚ï¼Œè¯¥æ–¹æ³•æè¿°äº†å±‚å¦‚ä½•è½¬æ¢å¼ é‡ã€‚</p>
<p>æœ€é‡è¦çš„æ–¹æ³•æ˜¯ <code>call</code>
æ–¹æ³•ï¼Œå®ƒå®šä¹‰äº†å¼ é‡åœ¨è¯¥å±‚ä¸­çš„è½¬æ¢è¿‡ç¨‹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å…¨è¿æ¥å±‚ï¼ˆå³çº¿æ€§å±‚ï¼‰çš„å®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Linear</span>(layers.Layer):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, units=<span class="number">32</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(Linear, self).__init__()</span><br><span class="line">        self.units = units</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">build</span>(<span class="params">self, input_shape</span>):</span><br><span class="line">        self.w = self.add_weight(shape=(input_shape[-<span class="number">1</span>], self.units),</span><br><span class="line">                                 initializer=<span class="string">&#x27;random_normal&#x27;</span>,</span><br><span class="line">                                 trainable=<span class="literal">True</span>)</span><br><span class="line">        self.b = self.add_weight(shape=(self.units,),</span><br><span class="line">                                 initializer=<span class="string">&#x27;zeros&#x27;</span>,</span><br><span class="line">                                 trainable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">call</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        <span class="keyword">return</span> tf.matmul(inputs, self.w) + self.b</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ <code>Linear</code> å±‚çš„å®šä¹‰ä¸­ï¼Œ<code>build</code>
æ–¹æ³•å®šä¹‰äº†å±‚çš„æƒé‡ï¼ˆ<code>w</code> å’Œ
<code>b</code>ï¼‰ï¼Œ<code>call</code>
æ–¹æ³•å®šä¹‰äº†å¦‚ä½•ä½¿ç”¨è¿™äº›æƒé‡æ¥è®¡ç®—è¯¥å±‚çš„è¾“å‡ºã€‚</p>
<p><strong>é‡æ–°å‚æ•°åŒ–æŠ€å·§</strong> æˆ‘ä»¬å¯ä»¥ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸­å¯¹ epsilon
è¿›è¡Œé‡‡æ ·ï¼Œç„¶åæ‰‹åŠ¨è°ƒæ•´æ ·æœ¬ä»¥è·å¾—æ­£ç¡®çš„å‡å€¼å’Œæ–¹å·®ï¼Œè€Œä¸æ˜¯ç›´æ¥ä»å‚æ•°
z_mean å’Œ z_log_var
çš„æ­£æ€åˆ†å¸ƒä¸­è¿›è¡Œé‡‡æ ·ã€‚å®ƒæ„å‘³ç€æ¢¯åº¦å¯ä»¥åœ¨å±‚ä¸­è‡ªç”±åå‘ä¼ æ’­ã€‚é€šè¿‡ä¿æŒå˜é‡
epsilon
ä¸­åŒ…å«çš„å±‚çš„æ‰€æœ‰éšæœºæ€§ï¼Œå±‚è¾“å‡ºç›¸å¯¹äºå…¶è¾“å…¥çš„åå¯¼æ•°å¯ä»¥è¢«è¯æ˜æ˜¯ç¡®å®šæ€§çš„ã€‚</p>
<p>********************ä½¿ç”¨pyTorchå®ç°********************
åœ¨pyTorchä¸­å¯ä»¥ç”¨<code>nn.Module</code>
å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼Œåœ¨Moduleä¸­ï¼Œä½¿ç”¨<code>forward</code>æ¥ä»£æ›¿<code>layer</code>ä¸­çš„<code>call</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Sampling</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, inputs</span>):</span><br><span class="line">        z_mean, z_log_var = inputs</span><br><span class="line">        batch = z_mean.shape[<span class="number">0</span>]</span><br><span class="line">        dim = z_mean.shape[<span class="number">1</span>]</span><br><span class="line">        epsilon = torch.randn(batch, dim)</span><br><span class="line">        <span class="keyword">return</span> z_mean + torch.exp(<span class="number">0.5</span> * z_log_var) * epsilon</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹ç¼–ç å™¨">ä¿®æ”¹ç¼–ç å™¨</h3>
<p><strong>tensorflowçš„ä¿®æ”¹æ–¹æ¡ˆ</strong>
åŸæœ¬çš„ç¼–ç å™¨éœ€è¦ç”Ÿæˆä¸€ä¸ªç‚¹ï¼Œå³ä¸€ä¸ªäºŒç»´çš„å‘é‡ã€‚è€Œç°åœ¨çš„è¦åˆ†åˆ«ç”Ÿæˆä¸¤ä¸ªäºŒç»´çš„å‘é‡ï¼šå‡å€¼å’Œæ–¹å·®ã€‚å› æ­¤ï¼Œå°†åŸæœ¬çš„ï¼š<code>encoder_output = layers.Dense(2, name="encoder_output")(x)</code>
æ›¿æ¢ä¸ºç°åœ¨çš„ä¸¤è¡Œä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">z_mean = layers.Dense(<span class="number">2</span>, name=<span class="string">&quot;z_mean&quot;</span>)(x)</span><br><span class="line">z_log_var = layers.Dense(<span class="number">2</span>, name=<span class="string">&quot;z_log_var&quot;</span>)(x)</span><br></pre></td></tr></table></figure>
<p>å¹¶ä½¿ç”¨æ–°å®šä¹‰çš„Samplingå±‚ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ†å¸ƒz</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z = Sampling()([z_mean, z_log_var])</span><br></pre></td></tr></table></figure>
<p><strong>pyTorchçš„ä¿®æ”¹æ–¹æ¡ˆ</strong> åœ¨pytorchä¸­é¢å¤–å®šä¹‰ä¸Šè¿°ä¸‰å±‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.ZMEAN = nn.Linear(<span class="number">128</span>*<span class="number">4</span>*<span class="number">4</span>,EMBEDDING_DIM)</span><br><span class="line">self.ZLOGVAR = nn.Linear(<span class="number">128</span>*<span class="number">4</span>*<span class="number">4</span>,EMBEDDING_DIM)</span><br><span class="line">self.Sampling = Sampling()</span><br></pre></td></tr></table></figure>
<p>å¹¶åœ¨forwardä¸­ä¾æ¬¡é€šè¿‡ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">    x = self.encoder(x)</span><br><span class="line">    z_mean = self.ZMEAN(x)</span><br><span class="line">    z_log_var = self.ZLOGVAR(x)</span><br><span class="line">    x = self.Sampling([z_mean,z_log_var])</span><br><span class="line">    x = self.decoder(x)</span><br><span class="line">    <span class="keyword">return</span> z_mean,z_log_var,x</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹æŸå¤±å‡½æ•°">ä¿®æ”¹æŸå¤±å‡½æ•°</h3>
<blockquote>
<p>é™¤äº†åŸæœ¬çš„æŸå¤±å‡½æ•°ï¼Œéœ€è¦åœ¨å…¶ä¸Šå¢åŠ ä¸€é¡¹<strong><em>Kullbackâ€“Leibler
(KL) divergence term</em></strong> KLæ•£åº¦é¡¹</p>
</blockquote>
<p>************************************************KLæ•£åº¦é¡¹çš„å®šä¹‰************************************************
KL æ•£åº¦æ˜¯ä¸€ç§è¡¡é‡ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒä¸å¦ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒå·®å¼‚ç¨‹åº¦çš„æ–¹æ³•ã€‚åœ¨ VAE
ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦æµ‹é‡å‚æ•° z_mean å’Œ z_log_var
çš„æ­£æ€åˆ†å¸ƒä¸æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å·®å¼‚ç¨‹åº¦ã€‚å› æ­¤ï¼Œå¯ä»¥ç”±ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š</p>
<p><span class="math display">\[
D_{K L}\left[N(\mu, \sigma \| N(0,1)\right]=-\frac{1}{2}
\sum\left(1+\log \left(\sigma^2\right)-\mu^2-\sigma^2\right)
\]</span></p>
<ul>
<li>åœ¨tensorflowä¸­çš„ä½¿ç”¨ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kl_loss = tf.reduce_mean(</span><br><span class="line">                tf.reduce_sum(</span><br><span class="line">                    -<span class="number">0.5</span></span><br><span class="line">                    * (<span class="number">1</span> + z_log_var - tf.square(z_mean) - tf.exp(z_log_var)),</span><br><span class="line">                    axis=<span class="number">1</span>,</span><br><span class="line">                )</span><br><span class="line">            )</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨pyTorchä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è®¡ç®—ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kl_loss = torch.mean(-<span class="number">0.5</span> * torch.<span class="built_in">sum</span>(<span class="number">1</span> + z_log_var - z_mean.<span class="built_in">pow</span>(<span class="number">2</span>) - z_log_var.exp(),axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>VAEä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ½œåœ¨ç©ºé—´æœ‰è‰¯å¥½çš„ç»“æ„ï¼Œå³ç›¸ä¼¼çš„æ•°æ®ç‚¹åº”è¯¥è¢«æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ä¸­çš„ç›¸è¿‘ä½ç½®ã€‚é€šè¿‡æœ€å°åŒ–KLæ•£åº¦æŸå¤±ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç¼–ç å™¨äº§ç”Ÿçš„æ½œåœ¨åˆ†å¸ƒæ¥è¿‘äºç›®æ ‡åˆ†å¸ƒï¼Œè¿™æ ·å°±å¯ä»¥æ›´å¥½åœ°å®ç°æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå³åœ¨æ½œåœ¨ç©ºé—´ä¸­æœ‰è‰¯å¥½çš„æ•°æ®ç»„ç»‡ç»“æ„ã€‚</p>
<p><strong>æ–°çš„æŸå¤±å‡½æ•°å’Œå¼•å…¥æ¨¡å‹è®­ç»ƒçš„æ–¹å¼</strong>
æ¥ä¸‹æ¥è¦å°†æŸå¤±å‡½æ•°å¼•å…¥è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚</p>
<ul>
<li>tensorflowä¸­çš„å¼•å…¥æ–¹å¼ï¼šé‡å†™train_stepã€‚è¿™ç§æ–¹æ³•å¯ä»¥ä¿ç•™fit()çš„éå†æƒ³ï¼ŒåŒæ—¶ä½¿ç”¨è‡ªå·±çš„æ–¹æ³•è®­ç»ƒã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_step</span>(<span class="params">self, data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Step run during training.&quot;&quot;&quot;</span></span><br><span class="line">		<span class="comment"># åˆ›å»ºä¸€ä¸ªtf.GradientTapeä¸Šä¸‹æ–‡ï¼Œåªæœ‰è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰çš„æ“ä½œä¼šè¢«è®°å½•ï¼Œç”¨äºä¹‹åçš„è®¡ç®—æ¢¯åº¦</span></span><br><span class="line">    <span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:</span><br><span class="line">        z_mean, z_log_var, reconstruction = self(data)</span><br><span class="line">        <span class="comment"># è®¡ç®—é‡æ„æŸå¤±ï¼Œè¿™æ˜¯åŸå§‹è¾“å…¥æ•°æ®å’Œé‡æ„æ•°æ®ä¹‹é—´çš„äºŒå…ƒäº¤å‰ç†µæŸå¤±çš„å¹³å‡å€¼ã€‚</span></span><br><span class="line">				reconstruction_loss = tf.reduce_mean(</span><br><span class="line">            BETA</span><br><span class="line">            * losses.binary_crossentropy(</span><br><span class="line">                data, reconstruction, axis=(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">				<span class="comment"># è®¡ç®—KLæ•£åº¦æŸå¤±ï¼Œè¿™æ˜¯ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒåˆ°æ¨¡å‹çš„æ½œåœ¨åˆ†å¸ƒçš„KLæ•£åº¦ã€‚</span></span><br><span class="line">        kl_loss = tf.reduce_mean(</span><br><span class="line">            tf.reduce_sum(</span><br><span class="line">                -<span class="number">0.5</span></span><br><span class="line">                * (<span class="number">1</span> + z_log_var - tf.square(z_mean) - tf.exp(z_log_var)),</span><br><span class="line">                axis=<span class="number">1</span>,</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">				<span class="comment"># å¾—åˆ°æ€»çš„æŸå¤±</span></span><br><span class="line">        total_loss = reconstruction_loss + kl_loss</span><br><span class="line">		<span class="comment"># è®¡ç®—æ€»æŸå¤±å…³äºå¯è®­ç»ƒæƒé‡çš„æ¢¯åº¦</span></span><br><span class="line">    grads = tape.gradient(total_loss, self.trainable_weights)</span><br><span class="line">		<span class="comment"># ä½¿ç”¨ä¼˜åŒ–å™¨åº”ç”¨è¿™äº›æ¢¯åº¦ï¼Œä»¥æ›´æ–°æƒé‡</span></span><br><span class="line">    self.optimizer.apply_gradients(<span class="built_in">zip</span>(grads, self.trainable_weights))</span><br><span class="line">		<span class="comment"># æ›´æ–°æŸå¤±è·Ÿè¸ªå™¨çš„çŠ¶æ€ï¼Œè¿™äº›è·Ÿè¸ªå™¨ç”¨äºè·Ÿè¸ªè®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±ã€‚</span></span><br><span class="line">    self.total_loss_tracker.update_state(total_loss)</span><br><span class="line">    self.reconstruction_loss_tracker.update_state(reconstruction_loss)</span><br><span class="line">    self.kl_loss_tracker.update_state(kl_loss)</span><br><span class="line">    <span class="keyword">return</span> &#123;m.name: m.result() <span class="keyword">for</span> m <span class="keyword">in</span> self.metrics&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨pyTorchä¸­çš„å¼•å…¥ï¼Œåªéœ€è¦åœ¨ç›¸åº”çš„è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨æ–°å®šä¹‰çš„æŸå¤±å‡½æ•°å³å¯ã€‚ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(EPOCHS):</span><br><span class="line">    <span class="keyword">for</span> x,_ <span class="keyword">in</span> trainloader:</span><br><span class="line">        x = x.cuda()</span><br><span class="line">        z_mean,z_log_var,reconstruction = vae(x)</span><br><span class="line">        loss = vae.loss_function(x,z_mean,z_log_var,reconstruction)</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">    test_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> y,_ <span class="keyword">in</span> testloader:</span><br><span class="line">        y = y.cuda()</span><br><span class="line">        z_mean,z_log_var,reconstruction = vae(y)</span><br><span class="line">        test_loss += vae.loss_function(y,z_mean,z_log_var,reconstruction)</span><br><span class="line">    test_loss /= <span class="built_in">len</span>(testloader)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Epoch: <span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>,  Test Loss: <span class="subst">&#123;test_loss&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="è®­ç»ƒç»“æœ">è®­ç»ƒç»“æœ</h2>
<p>KL æ•£åº¦æŸå¤±é¡¹ç¡®ä¿ç¼–ç å›¾åƒçš„ z_mean å’Œ z_log_var
å€¼æ°¸è¿œä¸ä¼šåç¦»æ ‡å‡†æ­£æ€åˆ†å¸ƒå¤ªè¿œã€‚ç”±äºç¼–ç å™¨ç°åœ¨æ˜¯éšæœºçš„ï¼Œè€Œä¸æ˜¯ç¡®å®šæ€§çš„ï¼Œå› æ­¤æ½œåœ¨ç©ºé—´ç°åœ¨æ›´åŠ è¿ç»­ï¼Œå› æ­¤ä¸å­˜åœ¨å¤ªå¤šå½¢æˆä¸è‰¯çš„å›¾åƒã€‚</p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_7.png" /></p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_8.png" /></p>
<p>é€šè¿‡æŒ‰æœè£…ç±»å‹å¯¹æ½œåœ¨ç©ºé—´ä¸­çš„ç‚¹è¿›è¡Œç€è‰²ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•ä¸€ç§ç±»å‹å—åˆ°ä¼˜å…ˆå¯¹å¾…ã€‚å³ä¾§å›¾æ˜¾ç¤ºäº†è½¬æ¢ä¸º
p å€¼çš„ç©ºé—´ -
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ç§é¢œè‰²çš„è¡¨ç¤ºå¤§è‡´ç›¸åŒã€‚å†æ¬¡å¼ºè°ƒï¼Œé‡è¦çš„æ˜¯è¦è®°ä½ï¼Œåœ¨è®­ç»ƒæœŸé—´æ ¹æœ¬æ²¡æœ‰ä½¿ç”¨æ ‡ç­¾ï¼›
VAE è‡ªè¡Œå­¦ä¹ äº†å„ç§å½¢å¼çš„æœè£…ï¼Œä»¥å¸®åŠ©æœ€å¤§é™åº¦åœ°å‡å°‘é‡å»ºæŸå¤±ã€‚</p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_9.png" /></p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_10.png" /></p>
<h1 id="æ›´é«˜ç»´åº¦çš„vae">æ›´é«˜ç»´åº¦çš„VAE</h1>
<h2 id="celebaæ•°æ®é›†">CelebAæ•°æ®é›†</h2>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_11.png" /></p>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ CelebFaces Attributes (CelebA)
æ•°æ®é›†æ¥è®­ç»ƒæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ã€‚è¿™æ˜¯è¶…è¿‡ 200,000
å¼ åäººé¢å­”å½©è‰²å›¾åƒçš„é›†åˆï¼Œæ¯å¼ å›¾åƒéƒ½é™„æœ‰å„ç§æ ‡ç­¾ï¼ˆä¾‹å¦‚æˆ´å¸½å­ã€å¾®ç¬‘ç­‰ï¼‰ã€‚</p>
<h3 id="æ•°æ®é›†åŠ è½½">æ•°æ®é›†åŠ è½½</h3>
<p><strong>tensorflowçš„åŠ è½½æ–¹å¼</strong>
ä½¿ç”¨tensorflowçš„å‡½æ•°<code>image_dataset_from_directory</code>
ä»æŒ‡å®šçš„åœ°å€åŠ è½½å›¾åƒæ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">train_data = utils.image_dataset_from_directory(</span><br><span class="line">    <span class="string">&quot;/app/data/celeba-dataset/img_align_celeba/img_align_celeba&quot;</span>,</span><br><span class="line">    labels=<span class="literal">None</span>,</span><br><span class="line">    color_mode=<span class="string">&quot;rgb&quot;</span>,</span><br><span class="line">    image_size=(IMAGE_SIZE, IMAGE_SIZE),</span><br><span class="line">    batch_size=BATCH_SIZE,</span><br><span class="line">    shuffle=<span class="literal">True</span>,</span><br><span class="line">    seed=<span class="number">42</span>,</span><br><span class="line">    interpolation=<span class="string">&quot;bilinear&quot;</span>,</span><br><span class="line">)</span><br><span class="line"><span class="comment"># Preprocess the data</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">preprocess</span>(<span class="params">img</span>):</span><br><span class="line">    img = tf.cast(img, <span class="string">&quot;float32&quot;</span>) / <span class="number">255.0</span></span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line">train = train_data.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: preprocess(x))</span><br></pre></td></tr></table></figure>
<ul>
<li><code>labels=None</code>ï¼šè¡¨ç¤ºä¸ä»ç›®å½•ç»“æ„ä¸­æ¨æ–­æ ‡ç­¾ï¼Œå› ä¸ºè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ— ç›‘ç£å­¦ä¹ ä»»åŠ¡ã€‚</li>
<li><code>color_mode="rgb"</code>ï¼šè¡¨ç¤ºå°†å›¾åƒåŠ è½½ä¸º RGB ä¸‰é€šé“ã€‚</li>
<li><code>image_size=(IMAGE_SIZE, IMAGE_SIZE)</code>ï¼šè¡¨ç¤ºå°†å›¾åƒè°ƒæ•´ä¸ºæŒ‡å®šçš„å¤§å°ã€‚</li>
<li><code>batch_size=BATCH_SIZE</code>ï¼šè¡¨ç¤ºåœ¨æ¯æ¬¡è¿­ä»£ä¸­ä»æ•°æ®é›†ä¸­æŠ½å–çš„æ ·æœ¬æ•°é‡ã€‚</li>
<li><code>shuffle=True</code>ï¼šè¡¨ç¤ºåœ¨æ¯ä¸ª epoch
å¼€å§‹æ—¶éƒ½è¦æ‰“ä¹±æ•°æ®é›†ã€‚</li>
<li><code>seed=42</code>ï¼šè¿™æ˜¯éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ï¼Œç”¨äºæ‰“ä¹±æ•°æ®é›†å’Œè¿›è¡Œå…¶ä»–éšæœºæ“ä½œã€‚</li>
<li><code>interpolation="bilinear"</code>ï¼šè¿™æ˜¯ç”¨äºè°ƒæ•´å›¾åƒå¤§å°æ—¶çš„æ’å€¼æ–¹æ³•ã€‚</li>
<li>æœ€åä½¿ç”¨<code>preprocess</code>å‡½æ•°å¤„ç†è¿™äº›å›¾åƒï¼Œ<code>train = train_data.map(lambda x: preprocess(x))</code>
æ„å‘³ç€å°†è¿™ä¸ªå‡½æ•°ä½œç”¨åœ¨è®­ç»ƒé›†çš„æ‰€æœ‰æ•°æ®ä¸Šã€‚</li>
</ul>
<p><strong>pyTorchçš„åŠ è½½æ–¹å¼</strong> å¯ä»¥ä½¿ç”¨<code>ImageFolder</code>
ä»æŒ‡å®šåœ°å€åŠ è½½æ•°æ®é›†ï¼Œå¹¶å®šä¹‰è‡ªå·±transformå‡½æ•°æ¥å®ç°è½¬æ¢ã€‚ç›¸å¯¹æ¥è¯´è¦æ¯”kerasç®€å•ä¸€äº›ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰è½¬æ¢</span></span><br><span class="line">transform = transforms.Compose([</span><br><span class="line">    transforms.Resize((IMAGE_SIZE, IMAGE_SIZE)),  <span class="comment"># è°ƒæ•´å›¾åƒå¤§å°</span></span><br><span class="line">    transforms.ToTensor(),  <span class="comment"># å°† PIL å›¾åƒæˆ– NumPy ndarray è½¬æ¢ä¸º tensor</span></span><br><span class="line">    transforms.Normalize(mean=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>], std=[<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>])  <span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ•°æ®é›†</span></span><br><span class="line">dataset = datasets.ImageFolder(<span class="string">&quot;/app/data/celeba-dataset/img_align_celeba/img_align_celeba&quot;</span>, transform=transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®åŠ è½½å™¨</span></span><br><span class="line">dataloader = DataLoader(dataset, batch_size=BATCH_SIZE, shuffle=<span class="literal">True</span>, num_workers=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹ä¿®æ”¹">æ¨¡å‹ä¿®æ”¹</h2>
<p>æ¨¡å‹çš„ä¿®æ”¹æ¶‰åŠåˆ°ç½‘ç»œä¸Šçš„ä¿®æ”¹å’Œå‚æ•°çš„ä¼˜åŒ–ï¼Œå¯ç›´æ¥å‚è€ƒåŸä¹¦çš„ä»£ç ï¼Œç”±äºåŸºæœ¬ç»“æ„æ²¡æœ‰å˜åŒ–ï¼Œåªéœ€è¦æ ¹æ®éœ€è¦ä¿®æ”¹çš„å‚æ•°å’Œç½‘ç»œä¿®æ”¹ç›¸åº”ä»£ç å³å¯ï¼Œè¿™é‡Œä¸å†è¯¦è¿°ã€‚</p>
<h2 id="æ½œåœ¨ç©ºé—´åˆ†æ">æ½œåœ¨ç©ºé—´åˆ†æ</h2>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬æƒ³æ‹æ‘„ä¸€å¼ çœ‹èµ·æ¥æ‚²ä¼¤çš„äººçš„ç…§ç‰‡å¹¶ç»™ä»–ä»¬ä¸€ä¸ªå¾®ç¬‘ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨æ½œåœ¨ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªæŒ‡å‘å¾®ç¬‘å¢åŠ æ–¹å‘çš„å‘é‡ã€‚å°†æ­¤å‘é‡æ·»åŠ åˆ°æ½œåœ¨ç©ºé—´ä¸­åŸå§‹å›¾åƒçš„ç¼–ç ä¸­å°†ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªæ–°ç‚¹ï¼Œåœ¨è§£ç æ—¶ï¼Œè¯¥æ–°ç‚¹åº”è¯¥ä¸ºæˆ‘ä»¬æä¾›åŸå§‹å›¾åƒçš„æ›´å¤šç¬‘è„¸ç‰ˆæœ¬ã€‚</p>
</blockquote>
<h3 id="smilingç‰¹å¾å‘é‡">Smilingç‰¹å¾å‘é‡</h3>
<p>CelebA æ•°æ®é›†ä¸­çš„æ¯å¼ å›¾åƒéƒ½æ ‡æœ‰å±æ€§ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å¾®ç¬‘ã€‚å¦‚æœæˆ‘ä»¬å°†å…·æœ‰
Smiling å±æ€§çš„ç¼–ç å›¾åƒåœ¨æ½œåœ¨ç©ºé—´ä¸­çš„å¹³å‡ä½ç½®å‡å»ä¸å…·æœ‰ Smiling
å±æ€§çš„ç¼–ç å›¾åƒçš„å¹³å‡ä½ç½®ï¼Œæˆ‘ä»¬å°†è·å¾—æŒ‡å‘ Smiling æ–¹å‘çš„å‘é‡ã€‚</p>
<p><span class="math display">\[
z_{new} = z+\alpha\cdot feature\_vecture
\]</span></p>
<p>å†å°†è¿™ä¸ªç‰¹å¾å‘é‡ä¸€ä¸ª<span
class="math inline">\(\alpha\)</span>çš„æ¯”ä¾‹ç³»æ•°åŠ è½½åŸæœ¬çš„å‘é‡ä¸Šï¼Œåˆ™å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ›´åŠ æ¥è¿‘ä¸å¾®ç¬‘çš„å‘é‡ã€‚</p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_12.png" /></p>
<h3 id="é¢éƒ¨ä¿¡æ¯æ··åˆ">é¢éƒ¨ä¿¡æ¯æ··åˆ</h3>
<blockquote>
<p>æƒ³è±¡æ½œåœ¨ç©ºé—´ä¸­çš„ä¸¤ä¸ªç‚¹ A å’Œ Bï¼Œå®ƒä»¬ä»£è¡¨ä¸¤ä¸ªå›¾åƒã€‚å¦‚æœæ‚¨ä» A
ç‚¹å¼€å§‹ï¼Œæ²¿ç›´çº¿æœ B
ç‚¹èµ°ï¼Œè¾¹èµ°è¾¹è§£ç çº¿ä¸Šçš„æ¯ä¸ªç‚¹ï¼Œæ‚¨ä¼šçœ‹åˆ°ä»èµ·å§‹é¢åˆ°ç»“æŸé¢çš„é€æ¸è¿‡æ¸¡ã€‚ç”±æ­¤å¯ä»¥å®ç°é¢éƒ¨ä¿¡æ¯çš„æ··åˆã€‚</p>
</blockquote>
<p><span class="math display">\[
z_{new} = z_A * (1- \alpha) + z_B * \alpha
\]</span></p>
<p><img
src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FGenerative_3%2FUntitled_13.png" /></p>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨æ˜¯ç”Ÿæˆæ¨¡å‹å·¥å…·ç®±ä¸­çš„ä¸€ç§å¼ºå¤§å·¥å…·ã€‚æˆ‘ä»¬é¦–å…ˆæ¢ç´¢äº†å¦‚ä½•ä½¿ç”¨æ™®é€šçš„è‡ªåŠ¨ç¼–ç å™¨å°†é«˜ç»´åº¦çš„å›¾åƒæ˜ å°„åˆ°ä½ç»´åº¦çš„æ½œåœ¨ç©ºé—´ï¼Œä»è€Œä»å„ä¸ªæ— ä¿¡æ¯çš„åƒç´ ä¸­æå–å‡ºé«˜çº§ç‰¹å¾ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¾ˆå¿«å‘ç°ä½¿ç”¨æ™®é€šè‡ªåŠ¨ç¼–ç å™¨ä½œä¸ºç”Ÿæˆæ¨¡å‹å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚ï¼Œä»å­¦ä¹ çš„æ½œåœ¨ç©ºé—´ä¸­è¿›è¡Œé‡‡æ ·å­˜åœ¨é—®é¢˜ã€‚</p>
<p>å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨é€šè¿‡å¼•å…¥éšæœºæ€§å’Œçº¦æŸæ½œåœ¨ç©ºé—´ä¸­çš„ç‚¹åˆ†å¸ƒæ¥è§£å†³è¿™äº›é—®é¢˜ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œé€šè¿‡ä¸€äº›å°çš„è°ƒæ•´ï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„è‡ªåŠ¨ç¼–ç å™¨è½¬å˜ä¸ºå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼Œä»è€Œèµ‹äºˆå®ƒæˆä¸ºçœŸæ­£çš„ç”Ÿæˆæ¨¡å‹çš„èƒ½åŠ›ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°†æ–°çš„æŠ€æœ¯åº”ç”¨åˆ°é¢éƒ¨ç”Ÿæˆé—®é¢˜ä¸­ï¼Œçœ‹åˆ°æˆ‘ä»¬å¦‚ä½•å¯ä»¥ç®€å•åœ°ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸­è§£ç ç‚¹æ¥ç”Ÿæˆæ–°çš„é¢éƒ¨ã€‚æ­¤å¤–ï¼Œé€šè¿‡åœ¨æ½œåœ¨ç©ºé—´å†…è¿›è¡Œå‘é‡ç®—æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€äº›æƒŠäººçš„æ•ˆæœï¼Œå¦‚é¢éƒ¨å˜å½¢å’Œç‰¹å¾æ“ä½œã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://raphaelhyaan.cn">Raphael Hyaan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://raphaelhyaan.cn/2024/01/20/Generative_3/">http://raphaelhyaan.cn/2024/01/20/Generative_3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://raphaelhyaan.cn" target="_blank">Raphael's Home</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ ç¬”è®°</a><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/01/20/Generative_4/" title="Chapter 4 Generative Adversarial Networks ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" onerror="onerror=null;src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Chapter 4 Generative Adversarial Networks ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/20/Generative_2/" title="Chapter 2 Deep Learning"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" onerror="onerror=null;src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Chapter 2 Deep Learning</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2023/11/22/DCGAN-1/" title="DCGAN"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/post%2FDCGAN%2FUntitled.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-22</div><div class="title">DCGAN</div></div></a></div><div><a href="/2024/01/20/Generative/" title="ç”Ÿæˆå¼ç¥ç»ç½‘ç»œæ€»è§ˆ"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="title">ç”Ÿæˆå¼ç¥ç»ç½‘ç»œæ€»è§ˆ</div></div></a></div><div><a href="/2024/01/20/Generative_1/" title="Chapter 1 Generative Modeling"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="title">Chapter 1 Generative Modeling</div></div></a></div><div><a href="/2024/01/20/Generative_2/" title="Chapter 2 Deep Learning"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="title">Chapter 2 Deep Learning</div></div></a></div><div><a href="/2024/01/20/Generative_10/" title="Chapter 10 Advanced GANs å„ç§å„æ ·çš„GAN"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="title">Chapter 10 Advanced GANs å„ç§å„æ ·çš„GAN</div></div></a></div><div><a href="/2024/01/20/Generative_5/" title="Chapter 5 Autoregressive Models è‡ªå›å½’æ¨¡å‹"><img class="cover" src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fgenerative.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-20</div><div class="title">Chapter 5 Autoregressive Models è‡ªå›å½’æ¨¡å‹</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Fe747243b42e6168d02fdf8bccbbd4ea.jpg" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffriend_404.gif'" alt="avatar"/></div><div class="author-info__name">Raphael Hyaan</div><div class="author-info__description">ä½•æ—¥å¯è°“å½’å»æ¥</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">111</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/raphaelhyaan"><i class="fab fa-github"></i><span>Bonjour</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/raphaelhyaan" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:raphael.ma.yuhan@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä»°è§‚å®‡å®™ä¹‹å¤§ï¼Œä¿¯å¯Ÿå“ç±»ä¹‹ç››</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#chapter-3-variational-autoencoders-%E8%87%AA%E5%8A%A8%E5%8F%98%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">Chapter 3
Variational Autoencoders è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%85%E4%BA%8B"><span class="toc-number">2.1.</span> <span class="toc-text">æ•…äº‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">3.</span> <span class="toc-text">è‡ªåŠ¨ç¼–ç å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%95%85%E4%BA%8B%E7%9A%84%E5%AF%B9%E5%BA%94"><span class="toc-number">3.0.1.</span> <span class="toc-text">ä¸æ•…äº‹çš„å¯¹åº”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%96%E7%A0%81%E5%99%A8-1"><span class="toc-number">3.0.2.</span> <span class="toc-text">è‡ªåŠ¨ç¼–ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fashion-mnist-%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">3.0.3.</span> <span class="toc-text">Fashion-MNIST æ•°æ®é›†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%96%E7%A0%81%E5%99%A8%E6%9E%B6%E6%9E%84"><span class="toc-number">3.1.</span> <span class="toc-text">è‡ªåŠ¨ç¼–ç å™¨æ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">3.1.1.</span> <span class="toc-text">ç¼–ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E7%BD%AE%E5%8D%B7%E7%A7%AF%E5%B1%82"><span class="toc-number">3.1.2.</span> <span class="toc-text">è½¬ç½®å·ç§¯å±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-number">3.1.3.</span> <span class="toc-text">è§£ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E7%BC%96%E7%A0%81%E5%99%A8%E5%92%8C%E8%A7%A3%E7%A0%81%E5%99%A8"><span class="toc-number">3.1.4.</span> <span class="toc-text">è¿æ¥ç¼–ç å™¨å’Œè§£ç å™¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">3.2.</span> <span class="toc-text">æ¨¡å‹è®­ç»ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E4%BC%98%E5%8C%96%E5%99%A8%E5%92%8C%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text">é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">3.2.2.</span> <span class="toc-text">å¼€å§‹è®­ç»ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%BB%BA%E5%9B%BE%E5%83%8F"><span class="toc-number">3.2.3.</span> <span class="toc-text">é‡å»ºå›¾åƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84%E5%9B%BE%E5%83%8F"><span class="toc-number">3.2.4.</span> <span class="toc-text">ç”Ÿæˆæ–°çš„å›¾åƒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%96%E7%A0%81%E5%99%A8%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">3.3.</span> <span class="toc-text">è‡ªåŠ¨ç¼–ç å™¨å­˜åœ¨çš„é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8pytorch%E7%9A%84%E5%B0%9D%E8%AF%95"><span class="toc-number">4.</span> <span class="toc-text">ä½¿ç”¨pytorchçš„å°è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">4.0.1.</span> <span class="toc-text">æ•°æ®é¢„å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD"><span class="toc-number">4.0.2.</span> <span class="toc-text">æ•°æ®åŠ è½½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%BC%96%E7%A0%81%E5%99%A8-2"><span class="toc-number">4.0.3.</span> <span class="toc-text">è‡ªåŠ¨ç¼–ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E8%AE%AD%E7%BB%83-1"><span class="toc-number">4.0.4.</span> <span class="toc-text">å¼€å§‹è®­ç»ƒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8F%98%E5%88%86%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">è‡ªåŠ¨å˜åˆ†ç¼–ç å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E4%BA%8B-1"><span class="toc-number">5.0.1.</span> <span class="toc-text">æ•…äº‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">5.1.</span> <span class="toc-text">æ¨¡å‹æ¶æ„çš„ä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E5%A4%9A%E5%85%83%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E6%98%A0%E5%B0%84"><span class="toc-number">5.1.1.</span> <span class="toc-text">å‘å¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ˜ å°„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%87%E6%A0%B7%E5%B1%82"><span class="toc-number">5.1.2.</span> <span class="toc-text">é‡‡æ ·å±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%BC%96%E7%A0%81%E5%99%A8"><span class="toc-number">5.1.3.</span> <span class="toc-text">ä¿®æ”¹ç¼–ç å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.4.</span> <span class="toc-text">ä¿®æ”¹æŸå¤±å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83%E7%BB%93%E6%9E%9C"><span class="toc-number">5.2.</span> <span class="toc-text">è®­ç»ƒç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9B%B4%E9%AB%98%E7%BB%B4%E5%BA%A6%E7%9A%84vae"><span class="toc-number">6.</span> <span class="toc-text">æ›´é«˜ç»´åº¦çš„VAE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#celeba%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">6.1.</span> <span class="toc-text">CelebAæ•°æ®é›†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%8A%A0%E8%BD%BD"><span class="toc-number">6.1.1.</span> <span class="toc-text">æ•°æ®é›†åŠ è½½</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E4%BF%AE%E6%94%B9"><span class="toc-number">6.2.</span> <span class="toc-text">æ¨¡å‹ä¿®æ”¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BD%9C%E5%9C%A8%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90"><span class="toc-number">6.3.</span> <span class="toc-text">æ½œåœ¨ç©ºé—´åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smiling%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F"><span class="toc-number">6.3.1.</span> <span class="toc-text">Smilingç‰¹å¾å‘é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E9%83%A8%E4%BF%A1%E6%81%AF%E6%B7%B7%E5%90%88"><span class="toc-number">6.3.2.</span> <span class="toc-text">é¢éƒ¨ä¿¡æ¯æ··åˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/07/12/mg-m-2/" title="ä¹ç† 02 è°ƒæ€§ï¼ŒéŸ³é˜¶ï¼Œè°ƒå·ï¼ŒéŸ³ç¨‹å’Œä¸‰å’Œå¼¦"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fä¹ç†å’Œå‰ä»–.png" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="ä¹ç† 02 è°ƒæ€§ï¼ŒéŸ³é˜¶ï¼Œè°ƒå·ï¼ŒéŸ³ç¨‹å’Œä¸‰å’Œå¼¦"/></a><div class="content"><a class="title" href="/2024/07/12/mg-m-2/" title="ä¹ç† 02 è°ƒæ€§ï¼ŒéŸ³é˜¶ï¼Œè°ƒå·ï¼ŒéŸ³ç¨‹å’Œä¸‰å’Œå¼¦">ä¹ç† 02 è°ƒæ€§ï¼ŒéŸ³é˜¶ï¼Œè°ƒå·ï¼ŒéŸ³ç¨‹å’Œä¸‰å’Œå¼¦</a><time datetime="2024-07-12T08:17:12.000Z" title="å‘è¡¨äº 2024-07-12 16:17:12">2024-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/29/mg/" title="ä¹ç†å’Œå‰ä»–"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fä¹ç†å’Œå‰ä»–.png" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="ä¹ç†å’Œå‰ä»–"/></a><div class="content"><a class="title" href="/2024/06/29/mg/" title="ä¹ç†å’Œå‰ä»–">ä¹ç†å’Œå‰ä»–</a><time datetime="2024-06-29T08:46:30.000Z" title="å‘è¡¨äº 2024-06-29 16:46:30">2024-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/29/mg-m-1/" title="ä¹ç† 01 å£°éŸ³çš„ç‰¹æ€§ï¼ŒéŸ³ä¹è®°è°±æ³•ï¼ŒéŸ³é«˜ï¼ŒèŠ‚å¥"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fä¹ç†å’Œå‰ä»–.png" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="ä¹ç† 01 å£°éŸ³çš„ç‰¹æ€§ï¼ŒéŸ³ä¹è®°è°±æ³•ï¼ŒéŸ³é«˜ï¼ŒèŠ‚å¥"/></a><div class="content"><a class="title" href="/2024/06/29/mg-m-1/" title="ä¹ç† 01 å£°éŸ³çš„ç‰¹æ€§ï¼ŒéŸ³ä¹è®°è°±æ³•ï¼ŒéŸ³é«˜ï¼ŒèŠ‚å¥">ä¹ç† 01 å£°éŸ³çš„ç‰¹æ€§ï¼ŒéŸ³ä¹è®°è°±æ³•ï¼ŒéŸ³é«˜ï¼ŒèŠ‚å¥</a><time datetime="2024-06-29T08:46:28.000Z" title="å‘è¡¨äº 2024-06-29 16:46:28">2024-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/13/ht-2/" title="çƒ­äº¤æ¢å™¨ï¼Œçƒ­è¾å°„ Ã©changeur, rayonnement"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fht.png" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="çƒ­äº¤æ¢å™¨ï¼Œçƒ­è¾å°„ Ã©changeur, rayonnement"/></a><div class="content"><a class="title" href="/2024/06/13/ht-2/" title="çƒ­äº¤æ¢å™¨ï¼Œçƒ­è¾å°„ Ã©changeur, rayonnement">çƒ­äº¤æ¢å™¨ï¼Œçƒ­è¾å°„ Ã©changeur, rayonnement</a><time datetime="2024-06-13T15:32:24.000Z" title="å‘è¡¨äº 2024-06-13 23:32:24">2024-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/13/ht-1/" title="ä¼ çƒ­ï¼Œçƒ­ä¼ å¯¼, çƒ­å¯¹æµ transfert de chaleur, conduction, convection"><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ftop_image%2Fht.png" onerror="this.onerror=null;this.src='https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2Ffavicon.png'" alt="ä¼ çƒ­ï¼Œçƒ­ä¼ å¯¼, çƒ­å¯¹æµ transfert de chaleur, conduction, convection"/></a><div class="content"><a class="title" href="/2024/06/13/ht-1/" title="ä¼ çƒ­ï¼Œçƒ­ä¼ å¯¼, çƒ­å¯¹æµ transfert de chaleur, conduction, convection">ä¼ çƒ­ï¼Œçƒ­ä¼ å¯¼, çƒ­å¯¹æµ transfert de chaleur, conduction, convection</a><time datetime="2024-06-13T15:32:22.000Z" title="å‘è¡¨äº 2024-06-13 23:32:22">2024-06-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Raphael Hyaan</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="framework-info"><span>å¤‡æ¡ˆå·: </span><a href="href=&quot;https://beian.miit.gov.cn/&quot; ">äº¬ICPå¤‡2024051904å·</a><span class="footer-separator">|</span><img src="https://raphaelhyaan-1322456377.cos.ap-beijing.myqcloud.com/source%2F%E5%A4%87%E6%A1%88%E5%9B%BE%E6%A0%87.png" alt="MIT License" height="20" align="top"/><span> </span><a href="href=&quot;https://beian.mps.gov.cn/#/query/webSearch?code=11010802044068&quot; ">äº¬å…¬ç½‘å®‰å¤‡11010802044068å·</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>